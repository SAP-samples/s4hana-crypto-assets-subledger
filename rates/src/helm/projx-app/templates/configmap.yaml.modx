apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Values.services.app.name }}
data:
  TENANT_HOST_PATTERN: "^(.*)-{{ .Values.services.app.name }}.{{ .Values.clusterDomain }}"
  destinations: |
    [
      {
        "name": "srv",
        "url": "http://{{ .Values.services.srv.name }}.{{ .Release.Namespace }}.svc.cluster.local:{{ .Values.services.srv.service.port }}",
        "forwardAuthToken": true
      },
      {
        "name": "srvjs",
        "url": "http://{{ .Values.services.srvjs.name }}.{{ .Release.Namespace }}.svc.cluster.local:{{ .Values.services.srvjs.service.port }}",
        "forwardAuthToken": true
      },
      {
        "name": "modx",
        "url": "http://{{ .Values.services.modx.name }}.{{ .Release.Namespace }}.svc.cluster.local:{{ .Values.services.modx.service.port }}",
        "forwardAuthToken": true
      }
    ]